<UserControl x:Class="MeisterGeister.View.Kampf.KampfView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:e="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:ViewGeneral="clr-namespace:MeisterGeister.View.General"
             xmlns:KampfLogic="clr-namespace:MeisterGeister.ViewModel.Kampf.Logic"
             xmlns:VM="clr-namespace:MeisterGeister.ViewModel.Kampf"
             mc:Ignorable="d" d:DesignHeight="615" d:DesignWidth="964" Background="{StaticResource Background1}">
    <UserControl.Resources>
        <ViewGeneral:EnumItemsSource x:Key="KampfstilValues" Type="{x:Type KampfLogic:Kampfstil}" />
        <ViewGeneral:EnumItemsSource x:Key="TrefferzonenValues" Type="{x:Type KampfLogic:Trefferzone}" />
        <ViewGeneral:InverseBooleanConverter x:Key="InverseBooleanConverter" />
        <ViewGeneral:EnumMatchToBooleanConverter x:Key="EnumMatchToBooleanConverter" />
        <ViewGeneral:ValueConverterGroup x:Key="EnumMatchThenInvert">
            <ViewGeneral:EnumMatchToBooleanConverter />
            <ViewGeneral:InverseBooleanConverter />
        </ViewGeneral:ValueConverterGroup>
        <VM:TrefferpunkteOptionsConverter x:Key="TrefferpunkteOptionsConverter" />
        <Style x:Key="MagiebegabtStyle" TargetType="{x:Type FrameworkElement}">
            <Setter Property="Visibility" Value="Collapsed" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=KämpferInfo.Kämpfer.Magiebegabt}" Value="true">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="GeweihtStyle" TargetType="{x:Type FrameworkElement}">
            <Setter Property="Visibility" Value="Collapsed" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=KämpferInfo.Kämpfer.Geweiht}" Value="true">
                    <Setter Property="Visibility" Value="Visible" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="KämpferListItemStyle" TargetType="{x:Type StackPanel}">
            <Setter Property="Opacity" Value="1.0" />
            <Setter Property="Background" Value="Transparent" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Kampfunfähig}" Value="true">
                    <Setter Property="Opacity" Value="0.3" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=AktuellerKämpfer}" Value="true">
                    <Setter Property="Background" Value="LightGreen" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="KämpferListItemNameStyle" TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="Black" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=KämpferInfo.Team}" Value="2">
                    <Setter Property="Foreground" Value="Sienna" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ListAktionItemStyle" TargetType="{x:Type StackPanel}">
            <Setter Property="Opacity" Value="1.0" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Vorbei}" Value="true">
                    <Setter Property="Opacity" Value="0.3" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <DataTemplate x:Key="AktionListTemplate">
            <StackPanel Orientation="Vertical" Style="{StaticResource ListAktionItemStyle}">
                <StackPanel Orientation="Horizontal">
                    <Label Visibility="{Binding Path=AktuellUi}" Foreground="#FFDB2A2A" FontFamily="Wingdings 2" Content="" />
                    <TextBlock Text="KR:"/>
                    <TextBlock Text="{Binding Path=InKampfrunde}" Margin="2,0,0,0"/>
                    <TextBlock Text=", Phase"/>
                    <TextBlock Text="{Binding Path=InPhase}" Margin="2,0,0,0"/>
                    <TextBlock Text=":"/>
                    <TextBlock Text="{Binding Path=Aktionsquelle}" Margin="4,0,0,0" FontWeight="Bold"/>
                    <TextBlock Text="{Binding Path=Aktionsname}" Margin="4,0,0,0"/>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="KämpferAktionListTemplate">
            <StackPanel Orientation="Vertical" Style="{StaticResource ListAktionItemStyle}">
                <StackPanel Orientation="Horizontal">
                    <Label Visibility="{Binding Path=AktuellUi}" Foreground="#FFDB2A2A" FontFamily="Wingdings 2" Content="" />
                    <TextBlock Text="KR:"/>
                    <TextBlock Text="{Binding Path=InKampfrunde}" Margin="2,0,0,0"/>
                    <TextBlock Text=", Phase"/>
                    <TextBlock Text="{Binding Path=InPhase}" Margin="2,0,0,0"/>
                    <TextBlock Text=":"/>
                    <TextBlock Text="{Binding Path=Aktionsname}" Margin="4,0,4,0"/>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="KämpferListTemplate">
            <StackPanel Orientation="Vertical" Style="{StaticResource KämpferListItemStyle}" >
                <TextBlock Text="{Binding Path=Kämpfer.Name}" FontWeight="Bold"  Style="{StaticResource KämpferListItemNameStyle}"/>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Path=InitiativeInfo}" Margin="8,2,0,0" ToolTip="{Binding Path=InitiativeInfoDetails}" />
                    <ViewGeneral:WürfelControl x:Name="_würfelControlInitiative" Ergebnis="{Binding Path=InitiativeWurf}" ErgebnisText="INI-Wurf" Würfel="{Binding Path=InitiativeZufall}" Height="23" Width="23" Margin="2,0,0,0" WürfelGeändert="WürfelControlInitiative_WürfelGeändert" />
                    <Rectangle Margin="4" Width="15" Height="15" Fill="{Binding Path=Farbmarkierung}" />
                    <!--
                    <TextBlock Text="Aktionen:" Margin="8,2,0,0" />
                    <TextBlock Text="{Binding Path=AktionenVerbleibend}" Margin="4,2,0,0" ToolTip="Noch nicht verbrauchte Aktionen in aktueller Kampfrunde." />
                    -->
                </StackPanel>
                <ListBox Margin="2,2,2,2" Name="_listBoxKämpferAktionen" ToolTip="Laufende Aktionen des Kämpfers" ItemTemplate="{StaticResource KämpferAktionListTemplate}" ItemsSource="{Binding Path=AktionenLaufend}"
                         BorderThickness="0"  Visibility="{Binding Path=IsChecked, ElementName=_checkBoxShowAktionen, Converter={StaticResource BooleanToVisibilityConverter1}}">
                    <ListBox.BorderBrush>
                        <SolidColorBrush />
                    </ListBox.BorderBrush>
                    <ListBox.Background>
                        <SolidColorBrush />
                    </ListBox.Background>
                </ListBox>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="InitiativeListManöverTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding Manöver.Name}" />
            </StackPanel>
        </DataTemplate>
        <HierarchicalDataTemplate x:Key="InitiativeListTemplate" ItemsSource="{Binding ThisAsList}" ItemTemplate="{StaticResource InitiativeListManöverTemplate}">
            <StackPanel Orientation="Vertical" Style="{StaticResource KämpferListItemStyle}" >
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding Initiative}" Width="20" Margin="0,0,2,0" />
                    <TextBlock Text="{Binding KämpferInfo.Kämpfer.Name}" FontWeight="Bold"  Style="{StaticResource KämpferListItemNameStyle}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <StackPanel.Style>
                        <Style>
                            <Setter Property="StackPanel.Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding InitiativeMod}" Value="0">
                                    <Setter Property="StackPanel.Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <ComboBox ItemsSource="{StaticResource KampfstilValues}" SelectedValue="{Binding KämpferInfo.Kämpfer.Kampfstil, Converter={StaticResource KampfstilValues}}" />
                    <TextBlock Text="{Binding KämpferInfo.Kämpfer.Angriffsaktionen}" ToolTip="Angriffsaktionen"/>
                    <Slider Minimum="0" Maximum="{Binding KämpferInfo.Kämpfer.Aktionen}" Value="{Binding KämpferInfo.Kämpfer.Abwehraktionen}" IsSnapToTickEnabled="True" Width="40"/>
                    <TextBlock Text="{Binding KämpferInfo.Kämpfer.Abwehraktionen}" ToolTip="Abwehraktionen"/>
                </StackPanel>
            </StackPanel>
        </HierarchicalDataTemplate>

        <Style x:Key="TreeViewItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ExpandCollapseToggleStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Width" Value="19"/>
            <Setter Property="Height" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Width="19" Height="13" Background="Transparent">
                            <Border SnapsToDevicePixels="true" Width="9" Height="9" BorderBrush="#FF7898B5" BorderThickness="1" CornerRadius="1">
                                <Border.Background>
                                    <LinearGradientBrush EndPoint="1,1" StartPoint="0,0">
                                        <GradientStop Color="White" Offset=".2"/>
                                        <GradientStop Color="#FFC0B7A6" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Path Margin="1,1,1,1" x:Name="ExpandPath" Fill="Black" Data="M 0 2 L 0 3 L 2 3 L 2 5 L 3 5 L 3 3 L 5 3 L 5 2 L 3 2 L 3 0 L 2 0 L 2 2 Z"/>
                            </Border>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Data" TargetName="ExpandPath" Value="M 0 2 L 0 3 L 5 3 L 5 2 Z"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="TreeViewItemStyle1" TargetType="{x:Type TreeViewItem}">
            <Setter Property="IsExpanded" Value="True" />
            <!-- <Setter Property="IsSelected" Value="{Binding IsSelected}" /> -->
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="Padding" Value="1,0,0,0"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
            <Setter Property="FocusVisualStyle" Value="{StaticResource TreeViewItemFocusVisual}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MinWidth="19" Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <!-- <ToggleButton x:Name="Expander" Style="{StaticResource ExpandCollapseToggleStyle}" ClickMode="Press" IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"/> -->
                            <Border SnapsToDevicePixels="true" x:Name="Bd" Grid.Column="1" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
                                <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" x:Name="PART_Header" ContentSource="Header"/>
                            </Border>
                            <ItemsPresenter x:Name="ItemsHost" Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="1"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="false">
                                <Setter Property="Visibility" TargetName="ItemsHost" Value="Collapsed"/>
                            </Trigger>
                            <!--<Trigger Property="HasItems" Value="false">
                                <Setter Property="Visibility" TargetName="Expander" Value="Hidden"/>
                            </Trigger>-->
                            <Trigger Property="IsSelected" Value="true">
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected" Value="true"/>
                                    <Condition Property="IsSelectionActive" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsAktion}" Value="false">
                    <Setter Property="TreeViewItem.IsExpanded" Value="False"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
       
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="235" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="280" />
        </Grid.ColumnDefinitions>
        <Grid Margin="4,4,0,4" Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border Style="{DynamicResource ControlContentBorder}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="90*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,2,0,0">
                        <CheckBox Name="_checkBoxShowAktionen" Content="Aktionen" Margin="5,3,0,3"  IsChecked="True" Height="19" ToolTip="Aktionen in Liste anzeigen" />
                        <Button Margin="6,0" Name="_buttonNächsterKämpfer" Command="{Binding OnNext}" Height="23" FontWeight="Bold" ToolTip="Wählt die nächste Aktion aus." HorizontalAlignment="Right">
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/DSA%20MeisterGeister;component/Images/Icons/General/pfeil_rechts.png" />
                                <TextBlock Text="Weiter" VerticalAlignment="Center" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    <TreeView Name="_treeInitiative" Grid.Row="1" Margin="2,2,2,2" ItemsSource="{Binding InitiativListe}" ItemTemplate="{StaticResource InitiativeListTemplate}" 
                             TreeViewItem.Selected="InitiativeListe_TreeViewItemSelected" KeyUp="ListBoxKämpfer_KeyUp" MouseDown="ListBoxKämpfer_MouseDown" Background="Transparent" Padding="4,8" ItemContainerStyle="{StaticResource TreeViewItemStyle1}">
                        <e:Interaction.Behaviors>
                            <ViewGeneral:BindableSelectedItemBehavior SelectedItem="{Binding SelectedManöverInfo, Mode=TwoWay}" PreferNestedItems="{Binding KämpferSelected, Converter={StaticResource InverseBooleanConverter}}" />
                        </e:Interaction.Behaviors>
                        <TreeView.InputBindings>
                            <KeyBinding Key="Delete" Command="{Binding OnDeleteKämpfer}" />
                        </TreeView.InputBindings>
                        <TreeView.BorderBrush>
                            <SolidColorBrush />
                        </TreeView.BorderBrush>
                        <TreeView.ContextMenu>
                            <ContextMenu Opened="ContextMenu_Opened">
                                <ContextMenu.Items>
                                    <MenuItem Name="_menuItemKämpferFarbmarkierung" Height="28" Header="Farbmarkierung setzen...">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/pinsel.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                        <MenuItem Background="Transparent" Header="Transparent" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Blue" Header="Blau" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="DarkBlue" Header="Dunkelblau" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Green" Header="Grün" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="DarkGreen" Header="Dunkelgrün" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Orange" Header="Orange" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Red" Header="Rot" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="DarkRed" Header="Dunkelrot" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Gold" Header="Gold" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Magenta" Header="Magenta" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Brown" Header="Braun" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="Black" Foreground="White" Header="Schwarz" Click="MenuItemKämpferFarbmarkierung_Click" />
                                        <MenuItem Background="White" Header="Weiß" Click="MenuItemKämpferFarbmarkierung_Click" />
                                    </MenuItem>
                                    <MenuItem Name="_menuItemKämpferAktuell" Height="28" Header="Als aktuellen Kämpfer setzen" Click="MenuItemKämpferAktuell_Click">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/nahkampf_01.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem Name="_menuItemKämpferEntfernen" Height="28" Header="Kämpfer/Held entfernen" Command="{Binding OnDeleteKämpfer}">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/kämpfer_entf.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem Name="_menuItemHeldenEinfügen" Height="28" Header="Helden einfügen" Command="{Binding OnAddHelden}">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/helden_add.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Name="_menuItemKämpferEinfügen" Height="28" Header="Gegner einfügen..." Command="{Binding OnShowGegnerView}">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/gegner_add.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem Name="_menuItemListeLeeren" Height="28" Header="Liste leeren" Click="MenuItemListeLeeren_Click">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Icons/clear_kampf.png" Stretch="Fill" Margin="2" />
                                        </MenuItem.Icon>
                                    </MenuItem>
                                </ContextMenu.Items>
                            </ContextMenu>
                        </TreeView.ContextMenu>
                    </TreeView>
                    <Image Grid.Row="1" Height="16" HorizontalAlignment="Right" Margin="0,4,4,0" Name="_imageInfoKämpferListe" Source="/Images/Icons/General/info.png" Stretch="Fill" Width="16" VerticalAlignment="Top">
                        <Image.ToolTip>
                            <StackPanel>
                                <TextBlock Height="Auto" TextWrapping="Wrap" Width="200">Rechtsklick für weitere Funktionen.</TextBlock>
                                <StackPanel Margin="0,6,0,0" Orientation="Horizontal">
                                    <Image Width="24" Source="/Images/Icons/Wuerfel/w6.png" VerticalAlignment="Top" />
                                    <TextBlock Margin="4,0,0,0" Height="Auto" TextWrapping="Wrap" Width="200">
                                    Rechtsklick auf den INI-Würfel, um das Ergebnis zu ändern. Mit einem Doppelklick wird neu gewürfelt.
                                    </TextBlock>
                                </StackPanel>
                            </StackPanel>
                        </Image.ToolTip>
                    </Image>
                    <Button Grid.Row="2" Height="23" Command="{Binding OnShowGegnerView}" Margin="2" ToolTip="Gegner-Verwaltung öffnen">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="/Images/Icons/gegner.png" />
                            <TextBlock Text="Gegner einfügen..." Margin="3,0" VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                </Grid>
            </Border>

        </Grid>
        <TabControl Margin="4" Grid.Column="1">
            <TabControl.Background>
                <SolidColorBrush />
            </TabControl.Background>
            <TabItem Name="_tabItemÜbersicht" Header="Übersicht">
                <ScrollViewer Name="_scrollViewerKämpferDetails" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <Border Style="{DynamicResource ControlContentBorder}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox Margin="6,6,2,2" Grid.ColumnSpan="2" Text="{Binding Path=SelectedItem.Name, ElementName=_listBoxKämpfer}" ToolTip="Name des Kämpfers" FontWeight="Bold" >
                                <TextBox.BorderBrush>
                                    <SolidColorBrush />
                                </TextBox.BorderBrush>
                                <TextBox.Background>
                                    <SolidColorBrush />
                                </TextBox.Background>
                            </TextBox>
                            <Image Name="_imageInfo" Grid.Column="1" Width="16" HorizontalAlignment="Right" Margin="0,3,3,0" Source="/Images/Icons/General/info.png" Stretch="Fill" Height="16" VerticalAlignment="Top">
                                <Image.ToolTip>
                                    <TextBlock Width="200" Height="Auto" TextWrapping="Wrap">
            		Um einen Wert zu verändern, einfach mit der Maus über das entsprechende Feld gehen und hineinklicken. Bei einigen Feldern kann man den Wert auch einfach mit dem Mausrad erhöhen bzw. senken.
                                    </TextBlock>
                                </Image.ToolTip>
                            </Image>
                            <StackPanel Grid.Row="1" Margin="0,8,0,0" Orientation="Vertical">
                                <!-- Lebensenergie -->
                                <StackPanel Margin="6,0,0,0" Orientation="Horizontal">
                                    <TextBlock Text="LE:" Margin="2,6,2,2" Width="25" />
                                    <TextBlock Margin="6,6,2,2" MinWidth="25" Text="{Binding Path=SelectedKämpferInfo.Kämpfer.LebensenergieMax}" ToolTip="Maximale Lebensenergie" />
                                    <TextBlock Text=" / " HorizontalAlignment="Left" Margin="0,6,0,2" />
                                    <ViewGeneral:IntBox Margin="2,2,2,2" MinWidth="60" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.LebensenergieAktuell, NotifyOnSourceUpdated=True}" ToolTip="Aktuelle Lebensenergie" FontWeight="Bold" SourceUpdated="_textBoxLebensenergieAktuell_SourceUpdated" ShowButtons="True" />
                                    <ViewGeneral:EnergieControl x:Name="_energieControlLebensenergie" Energie="Lebensenergie" SelectedKämpfer="{Binding SelectedKämpferInfo.Kämpfer}" />
                                </StackPanel>
                                <!-- Ausdauer -->
                                <StackPanel Margin="6,0,0,0" Orientation="Horizontal">
                                    <TextBlock Text="AU:" Margin="2,6,2,2" Width="25" />
                                    <TextBlock Margin="6,6,2,2" MinWidth="25" Text="{Binding Path=SelectedKämpferInfo.Kämpfer.AusdauerMax}" ToolTip="Maximale Ausdauer" />
                                    <TextBlock Text=" / " HorizontalAlignment="Left" Margin="0,6,0,2" />
                                    <ViewGeneral:IntBox Margin="2,2,2,2" MinWidth="60" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.AusdauerAktuell}" ToolTip="Aktuelle Ausdauer" FontWeight="Bold" ShowButtons="True" />
                                    <ViewGeneral:EnergieControl x:Name="_energieControlAusdauer" Energie="Ausdauer" SelectedKämpfer="{Binding Path=SelectedKämpferInfo.Kämpfer}" />
                                </StackPanel>
                                <!-- Astralenergie -->
                                <StackPanel Margin="6,0,0,0" Orientation="Horizontal" Style="{StaticResource MagiebegabtStyle}">
                                    <TextBlock Text="AE:" Margin="2,6,2,2" Width="25" />
                                    <TextBlock Margin="6,6,2,2" MinWidth="25" Text="{Binding Path=SelectedKämpferInfo.Kämpfer.AstralenergieMax}" ToolTip="Maximale Astralenergie" />
                                    <TextBlock Text=" / " HorizontalAlignment="Left" Margin="0,6,0,2" />
                                    <ViewGeneral:IntBox Margin="2,2,2,2" MinWidth="60" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.AstralenergieAktuell}" ToolTip="Aktuelle Astralenergie" FontWeight="Bold" ShowButtons="True" />
                                    <ViewGeneral:EnergieControl x:Name="_energieControlAstralenergie" Energie="Astralenergie" SelectedKämpfer="{Binding Path=SelectedKämpferInfo.Kämpfer}" />
                                </StackPanel>
                                <!-- Karmaenergie -->
                                <StackPanel Margin="6,0,0,0" Orientation="Horizontal" Style="{StaticResource GeweihtStyle}">
                                    <TextBlock Text="KE:" Margin="2,6,2,2" Width="25" />
                                    <TextBlock Margin="6,6,2,2" MinWidth="25" Text="{Binding Path=SelectedKämpferInfo.Kämpfer.KarmaenergieMax}" ToolTip="Maximale Karmaenergie" />
                                    <TextBlock Text=" / " HorizontalAlignment="Left" Margin="0,6,0,2" />
                                    <ViewGeneral:IntBox Margin="2,2,2,2" MinWidth="60" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.KarmaenergieAktuell}" ToolTip="Aktuelle Karmaenergie" FontWeight="Bold" ShowButtons="True" />
                                    <ViewGeneral:EnergieControl x:Name="_energieControlKarmaenergie" Energie="Karmaenergie" SelectedKämpfer="{Binding Path=SelectedKämpferInfo.Kämpfer}" />
                                </StackPanel>
                            </StackPanel>
                            <!-- Wunden und Rüstungsschutz -->
                            <Image Grid.Column="1" Source="/Images/Koerperzonen/koerperzonen_01.png" Height="213" ToolTip="Wunden und Rüstungsschutz" Grid.Row="1" VerticalAlignment="Top" HorizontalAlignment="Right" Width="133" Grid.RowSpan="1" />
                            <ViewGeneral:IntBox Margin="0,5,9,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[Gesamt]}" ToolTip="Rüstungsschutz (Gesamt)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,9,56,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[Kopf]}" ToolTip="Rüstungsschutz (Kopf)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,61,67,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[Brust]}" ToolTip="Rüstungsschutz (Brust)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,61,43,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[Rücken]}" ToolTip="Rüstungsschutz (Rücken)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,112,56,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[Bauch]}" ToolTip="Rüstungsschutz (Bauch)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,81,102,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[ArmR]}" ToolTip="Rüstungsschutz (rechter Arm)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,81,9,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[ArmL]}" ToolTip="Rüstungsschutz (linker Arm)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,171,92,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[BeinR]}" ToolTip="Rüstungsschutz (rechtes Bein)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />
                            <ViewGeneral:IntBox Margin="0,171,21,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.RS[BeinL]}" ToolTip="Rüstungsschutz (linkes Bein)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" WeissAufSchwarz="True" />

                            <ViewGeneral:IntBox Margin="0,31,56,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[Kopf]}" ToolTip="Wunden (Kopf)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" Width="23" HorizontalAlignment="Right" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,27,9,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[Unlokalisiert]}" ToolTip="Wunden (unlokalisiert)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Width="23" Height="23" VerticalAlignment="Top" HorizontalAlignment="Right" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,84,56,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[Brust]}" ToolTip="Wunden (Brust)" FontWeight="Bold" SourceUpdated="_textBoxWunden_SourceUpdated" MinValue="0" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" Width="23" Height="23" VerticalAlignment="Top" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,134,56,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[Bauch]}" ToolTip="Wunden (Bauch)" FontWeight="Bold" SourceUpdated="_textBoxWunden_SourceUpdated" MinValue="0" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" Width="23" Height="23" VerticalAlignment="Top" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,104,102,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[ArmR]}" ToolTip="Wunden (rechter Arm)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" Width="23" Height="23" VerticalAlignment="Top" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,104,9,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[ArmL]}" ToolTip="Wunden (linker Arm)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Width="23" Height="23" VerticalAlignment="Top" HorizontalAlignment="Right" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,171,71,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[BeinR]}" ToolTip="Wunden (rechtes Bein)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" Width="23" Height="23" VerticalAlignment="Top" MarkPlusValue="True" />
                            <ViewGeneral:IntBox Margin="0,171,42,0" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.WundenByZone[BeinL]}" ToolTip="Wunden (linkes Bein)" FontWeight="Bold" MinValue="0" Grid.Column="1" Grid.Row="1" Height="23" VerticalAlignment="Top" HorizontalAlignment="Right" Width="23" MarkPlusValue="True" />
                            <TextBox Grid.Row="2" Grid.ColumnSpan="2" Margin="4,0,0,0" Text="{Binding Path=SelectedItem.Kampfwerte, ElementName=_listBoxKämpfer}" ToolTip="Kampfwerte (z.B. Schwert: DK N AT 14 TP 1W6+2)" TextWrapping="Wrap" AcceptsReturn="True">
                                <TextBox.BorderBrush>
                                    <SolidColorBrush />
                                </TextBox.BorderBrush>
                                <TextBox.Background>
                                    <SolidColorBrush />
                                </TextBox.Background>
                            </TextBox>
                            <StackPanel Grid.Row="3" Grid.ColumnSpan="2" Margin="6,0,0,0" Orientation="Horizontal" >
                                <TextBlock Text="INI:" Margin="2,6,2,2" />
                                <ViewGeneral:IntBox Margin="2,2,2,2" Value="{Binding Path=SelectedKämpferInfo.Initiative}" ToolTip="Initiative" FontWeight="Bold" ShowButtons="True" />
                                <TextBlock Margin="2,6,2,2" Text="PA: " />
                                <ViewGeneral:IntBox Margin="2,2,2,2" Value="{Binding Path=SelectedKämpferInfo.Kämpfer.PA, Mode=OneWay}" ToolTip="Parade" FontWeight="Bold" NoBackground="True" />
                            </StackPanel>
                            <StackPanel Grid.Row="4" Grid.ColumnSpan="2" Orientation="Vertical">
                                <StackPanel Margin="6,0,0,0" Orientation="Horizontal">
                                    <TextBlock Margin="2,6,2,2" Text="BE: " />
                                    <ViewGeneral:IntBox Margin="2,2,2,2" Value="{Binding Path=SelectedItem.Behinderung, ElementName=_listBoxKämpfer, NotifyOnSourceUpdated=True}" ToolTip="Behinderung" FontWeight="Bold" SourceUpdated="_textBoxBehinderung_SourceUpdated" NoBackground="True" />
                                    <TextBlock Margin="6,6,2,2" Text="WS: " />
                                    <TextBlock Margin="2,6,2,2" Text="{Binding Path=SelectedItem.Wundschwellen, ElementName=_listBoxKämpfer}" FontWeight="Bold" ToolTip="Wundschwellen" />
                                </StackPanel>
                                <StackPanel Margin="6,0,0,2" Orientation="Horizontal" ToolTip="{Binding Path=SelectedItem.ModKampf_TextDetail, ElementName=_listBoxKämpfer, NotifyOnSourceUpdated=True}" >
                                    <TextBlock Margin="2,6,2,2" Text="Modifikatoren: " />
                                    <TextBlock Margin="6,6,2,2" Text="{Binding Path=SelectedItem.ModKampf_Text, ElementName=_listBoxKämpfer, NotifyOnSourceUpdated=True}" FontWeight="Bold" />
                                </StackPanel>
                            </StackPanel>
                            <Grid Grid.Row="5" Grid.ColumnSpan="2" Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="90" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <ViewGeneral:IntBox Grid.Row="0" Grid.RowSpan="2" Margin="8,0,4,0" x:Name="_intBoxSchaden" Value="{Binding Schaden}" ShowButtons="True" MinWidth="60" Height="Auto" ToolTip="SP/TP bzw. Abzug AE/KE" FontSize="16" />
                                <StackPanel Grid.Row="0" Grid.Column="1" Margin="6,0,0,0" Orientation="Horizontal">
                                    <StackPanel Margin="0" ToolTip="Wunden-Art" Orientation="Horizontal">
                                        <RadioButton GroupName="Wundschwelle" Name="_radioButtonWundschwelleNormal" VerticalAlignment="Center" Content="Normal" ToolTip="Mormale Wundschwelle." IsChecked="{Binding Path=WundschwellenOption, Mode=TwoWay, Converter={StaticResource EnumMatchToBooleanConverter}, ConverterParameter=Default}" />
                                        <RadioButton GroupName="Wundschwelle" Name="_radioButtonWundschwelleGesenkt" VerticalAlignment="Center" Content="WS -2" ToolTip="Wundschwelle um 2 gesenkt (Pfeil, Bolzen, Gezielter Stich, Todesstoß, etc.)." Margin="4,0,0,0" IsChecked="{Binding Path=WundschwellenOption, Mode=TwoWay, Converter={StaticResource EnumMatchToBooleanConverter}, ConverterParameter=VerringerteWundschwelle}"/>
                                        <RadioButton GroupName="Wundschwelle" Name="_radioButtonWundeKeine" VerticalAlignment="Center" Content="Keine" ToolTip="Keine Wunden." Margin="4,0,0,0" IsChecked="{Binding Path=WundschwellenOption, Mode=TwoWay, Converter={StaticResource EnumMatchToBooleanConverter}, ConverterParameter=KeineWunden}" />
                                    </StackPanel>
                                </StackPanel>
                                <Button Grid.Row="0" Grid.Column="2" Margin="2" Name="_buttonTrefferpunkte" Padding="0" Width="45" ToolTip="Trefferpunkte verrechnen" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                        Command="{Binding OnTrefferpunkte}">
                                    <Border Background="Firebrick">
                                        <Label Content="TP" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </Button>
                                <Button Grid.Row="0" Grid.Column="3" Margin="2" Name="_buttonSchadenspunkte" Width="45" ToolTip="Schadenspunkte verrechnen" Click="ButtonSchadenspunkte_Click" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                        Command="{Binding OnTrefferpunkte}">
                                    <Button.CommandParameter>
                                        <MultiBinding Converter="{StaticResource TrefferpunkteOptionsConverter}">
                                            <MultiBinding.Bindings>
                                                <Binding Source="{x:Static KampfLogic:TrefferpunkteOptions.IgnoriertRüstung}" Mode="OneWay"/>
                                            </MultiBinding.Bindings>
                                        </MultiBinding>
                                    </Button.CommandParameter>
                                    <Border Background="Firebrick">
                                        <Label Content="SP" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </Button>
                                <Button Grid.Row="0" Grid.Column="4" Margin="2" Style="{StaticResource MagiebegabtStyle}" Name="_buttonAstralpunkte" Width="45" ToolTip="AsP abziehen" Click="ButtonAstralpunkte_Click" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch">
                                    <Border Background="BlueViolet">
                                        <Label Content="AsP" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </Button>
                                <StackPanel Grid.Row="1" Grid.Column="1" Margin="6,0,0,0" Orientation="Horizontal">
                                    <ComboBox Name="_comboBoxTrefferzone" Margin="0,2,0,0" Width="109" ToolTip="Trefferzone" VerticalContentAlignment="Center"
                                              ItemsSource="{StaticResource TrefferzonenValues}" SelectedValue="{Binding SelectedTrefferzone, Converter={StaticResource TrefferzonenValues}}" />
                                    <CheckBox Margin="4,8,4,7" VerticalAlignment="Center" Name="_checkBoxAusdauerSchadenLeAbziehen" Content="-LeP" Background="SteelBlue" Foreground="DarkBlue" ToolTip="Halben Ausdauer-Schaden von der LE abziehen." IsChecked="{Binding Path=AusdauerSchadenMachtKeineSchadenspunkte, Mode=TwoWay, Converter={StaticResource EnumMatchThenInvert}, ConverterParameter=AusdauerschadenMachtKeineEchtenSchadenspunkte}" />
                                </StackPanel>
                                <Button Grid.Row="1" Grid.Column="2" Margin="2" Name="_buttonTrefferpunkteAusdauer" ToolTip="Ausdauer-Trefferpunkte verrechnen" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" Width="45"
                                        Command="{Binding OnTrefferpunkte}">
                                    <Button.CommandParameter>
                                        <MultiBinding Converter="{StaticResource TrefferpunkteOptionsConverter}">
                                            <MultiBinding.Bindings>
                                                <Binding Source="{x:Static KampfLogic:TrefferpunkteOptions.Ausdauerschaden}"/>
                                            </MultiBinding.Bindings>
                                        </MultiBinding>
                                    </Button.CommandParameter>
                                    <Border Background="SteelBlue">
                                        <Label Content="TP(A)" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </Button>
                                <Button Grid.Row="1" Grid.Column="3" Margin="2" Name="_buttonSchadenspunkteAusdauer" ToolTip="Ausdauer-Schadenspunkte verrechnen" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" Width="45"
                                        Command="{Binding OnTrefferpunkte}">
                                    <Button.CommandParameter>
                                        <MultiBinding Converter="{StaticResource TrefferpunkteOptionsConverter}">
                                            <MultiBinding.Bindings>
                                                <Binding Source="{x:Static KampfLogic:TrefferpunkteOptions.IgnoriertRüstung}"/>
                                                <Binding Source="{x:Static KampfLogic:TrefferpunkteOptions.Ausdauerschaden}"/>
                                            </MultiBinding.Bindings>
                                        </MultiBinding>
                                    </Button.CommandParameter>
                                    <Border Background="SteelBlue">
                                        <Label Content="SP(A)" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </Button>
                                <Button Grid.Row="1" Grid.Column="4" Margin="2" Style="{StaticResource GeweihtStyle}" Name="_buttonKarmapunkte" Width="45" ToolTip="KaP abziehen" Click="ButtonKarmapunkte_Click" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch">
                                    <Border Background="Gold">
                                        <Label Content="KaP" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                </Button>
                            </Grid>
                            <TextBox Grid.Row="6" Grid.ColumnSpan="2" Margin="6,6,0,0" Text="{Binding Path=SelectedItem.Besonderheiten, ElementName=_listBoxKämpfer}" ToolTip="Besonderheiten" TextWrapping="Wrap" FontSize="10" AcceptsReturn="True">
                                <TextBox.BorderBrush>
                                    <SolidColorBrush />
                                </TextBox.BorderBrush>
                                <TextBox.Background>
                                    <SolidColorBrush />
                                </TextBox.Background>
                            </TextBox>
                            <!--
                            <StackPanel Name="_stackPanelAktionIn" Grid.ColumnSpan="2" Grid.Row="7" Orientation="Horizontal" Visibility="Visible">
                                <Label Content="Aktion in:" Height="28" Margin="6,6,0,0" />
                                <RadioButton Content="{Binding Path=Content, ElementName=_radioButtonAktion1}" Height="16" Margin="2,6,4,0" IsChecked="{Binding Path=IsChecked, ElementName=_radioButtonAktion1}" />
                                <RadioButton Content="{Binding Path=Content, ElementName=_radioButtonAktion2}" Height="16" Margin="2,6,0,0" IsChecked="{Binding Path=IsChecked, ElementName=_radioButtonAktion2}" />
                            </StackPanel>-->
                        </Grid>
                    </Border>
                </ScrollViewer>
            </TabItem>
            <TabItem Name="_tabItemSfVorNach" Header="SF &amp; Vor-/Nachteile" ToolTip="Sonderfertigkeiten &amp; Vor-/Nachteile">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                    <Border Style="{DynamicResource ControlContentBorder}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <TextBox Grid.Row="0" Margin="6,6,0,0" Text="{Binding Path=SelectedItem.VorNachteile, ElementName=_listBoxKämpfer}" ToolTip="Vor-/Nachteile" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto">
                                <TextBox.BorderBrush>
                                    <SolidColorBrush />
                                </TextBox.BorderBrush>
                                <TextBox.Background>
                                    <SolidColorBrush />
                                </TextBox.Background>
                            </TextBox>
                            <TextBox Grid.Row="1" Margin="6,6,0,0" Text="{Binding Path=SelectedItem.Sonderfertigkeiten, ElementName=_listBoxKämpfer}" ToolTip="Sonderfertigkeiten" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto">
                                <TextBox.BorderBrush>
                                    <SolidColorBrush />
                                </TextBox.BorderBrush>
                                <TextBox.Background>
                                    <SolidColorBrush />
                                </TextBox.Background>
                            </TextBox>
                        </Grid>
                    </Border>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        <Grid Margin="4" Grid.Column="2" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Border Margin="2" Grid.Row="0" Style="{DynamicResource ControlContentBorder}">
                <Grid>
                    <Button Width="51" Height="47" HorizontalAlignment="Left" Margin="6,3,0,18" Name="_buttonArena" Click="ButtonArena_Click" ToolTip="Interaktiven Bodenplan öffnen">
                        <Image Source="/Images/Icons/bodenplan.png" Stretch="Uniform" />
                    </Button>
                    <CheckBox HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="6,0,0,2"  Name="_cbArena" FontSize="10" ToolTip="Kämpfer aus Liste in die Arena übernehmen" IsChecked="True">übernehmen</CheckBox>
                    <Button Name="_buttonSpielerInfo" Height="47" Width="28"  Click="ButtonSpielerInfo_Click" Visibility="Visible" HorizontalAlignment="Right" Margin="0,3,180,18">
                        <Button.ToolTip>
                            <TextBlock Width="200" Height="Auto" TextWrapping="Wrap">
            		Den Spielern die INI-Liste in einem separaten Fenster zeigen.
                            </TextBlock>
                        </Button.ToolTip>
                        <Image Source="/Images/Icons/General/screen.png" />
                    </Button>
                    <TextBlock Margin="0,3,94,0" Name="_textBlockKampfrunde" Text="{Binding Kampfrunde}" TextAlignment="Center" FontSize="22" ToolTip="Aktuelle Kampfrunde." HorizontalAlignment="Right" Width="82" Padding="0" Background="#FFDBDBDB" Height="43" VerticalAlignment="Top" />
                    <Button Content="Starten" Margin="0,4,6,0" Name="_buttonNeueKR" HorizontalAlignment="Right" Width="82" Click="ButtonNeueKampfrunde_Click" Height="23" VerticalAlignment="Top" FontWeight="Bold" />
                    <Button Content="Neuer Kampf" Height="23" Margin="0,32,6,0" Name="_buttonNeuerKampf" VerticalAlignment="Top" Click="ButtonNeuerKampf_Click" HorizontalAlignment="Right" Width="82" Opacity="0.7" ToolTip="Einen neuen Kampf beginnen." />
                    <TextBlock Background="#FFDBDBDB" FontSize="12" Height="17" HorizontalAlignment="Right" Margin="0,48,94,0" Name="_textBlockKampfZeit" Padding="0" Text="00:00:00" TextAlignment="Center" ToolTip="Verstrichene Zeit." VerticalAlignment="Top" Width="82" />
                </Grid>
            </Border>
            <Expander Grid.Row="1" Margin="2,5,2,2" IsExpanded="True">
                <Expander.Header>
                    <TextBlock Text="Aktionen" Style="{DynamicResource TextTitel}" />
                </Expander.Header>
                <Border Style="{DynamicResource ControlContentBorder}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid Margin="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="35*" />
                                <ColumnDefinition Width="65*" />
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" Height="23" Margin="2" Name="_textBoxAktionQuelle" VerticalAlignment="Top" ToolTip="Aktions-Quelle." />
                            <TextBox Grid.Column="1" Height="23" Margin="2" Name="_textBoxAktionName" VerticalAlignment="Top" ToolTip="Aktions-Beschreibung." />
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal">
                            <Label Content="Start in:" Height="28" Margin="2,6,0,0" Name="label5" />
                            <RadioButton Content="1. Aktion" Height="16" Margin="2,6,4,0" Name="_radioButtonAktion1" IsChecked="True" />
                            <RadioButton Content="2. Aktion" Height="16" Margin="2,6,0,0" Name="_radioButtonAktion2" />
                        </StackPanel>
                        <ViewGeneral:IntBox Height="25" HorizontalAlignment="Left" Margin="60,9,0,0" x:Name="_intBoxAktionDauer" VerticalAlignment="Top" Width="75" Value="2" Grid.Row="2" ToolTip="Aktions-Dauer in Aktionen." ShowButtons="True" />
                        <Label Content="Dauer:" Height="28" HorizontalAlignment="Left" Margin="2,9,0,0" VerticalAlignment="Top" Grid.Row="2" />
                        <Label Content="Aktionen" Height="28" HorizontalAlignment="Left" Margin="156,10,0,0" VerticalAlignment="Top" FontStyle="Italic" Grid.Row="2" />
                        <Button Content="▼" Height="23" Margin="0,11,4,0" Name="_buttonAktion" VerticalAlignment="Top" Click="ButtonAktion_Click" Grid.Row="2" HorizontalAlignment="Right" Width="23" ToolTip="Aktion einfügen." />
                    </Grid>
                </Border>
            </Expander>

            <Border Grid.Row="3" Margin="2" Style="{DynamicResource ControlContentBorder}">
                <ListBox Name="_listBoxAktionen" ToolTip="Aktionsliste" ItemTemplate="{StaticResource AktionListTemplate}" KeyUp="ListBoxAktionen_KeyUp" SelectionChanged="ListBoxAktionen_SelectionChanged"
                     MouseDoubleClick="ListBoxAktionen_MouseDoubleClick" MouseDown="ListBoxAktionen_MouseDown" Background="Transparent" Padding="4,8">
                    <ListBox.BorderBrush>
                        <SolidColorBrush />
                    </ListBox.BorderBrush>
                    <ListBox.ContextMenu>
                        <ContextMenu Name="_contextMenuAktionen" Opened="ContextMenuAktionen_Opened">
                            <ContextMenu.Items>
                                <MenuItem Name="_menuItemHandleAktionAlt" Height="28" Header="Alte Aktionen abschließen" Click="MenuItemHandleAktionAlt_Click">
                                    <MenuItem.Icon>
                                        <Image Source="/Images/Icons/General/ok.png" Stretch="Fill" Margin="2" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <MenuItem Name="_menuItemAktionEntfernen" Height="28" Header="Aktion entfernen" Click="MenuItemAktionEntfernen_Click">
                                    <MenuItem.Icon>
                                        <Image Source="/Images/Icons/General/entf_01.png" Stretch="Fill" Margin="2" />
                                    </MenuItem.Icon>
                                </MenuItem>
                                <Separator />
                                <MenuItem Name="_menuItemAktionListeLeeren" Height="28" Header="Liste leeren" Click="MenuItemAktionListeLeeren_Click">
                                    <MenuItem.Icon>
                                        <Image Source="/Images/Icons/General/entf_01.png" Stretch="Fill" Margin="2" />
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu.Items>
                        </ContextMenu>
                    </ListBox.ContextMenu>
                </ListBox>
            </Border>
            <Image HorizontalAlignment="Right" Margin="0,4,4,0" Name="image1" Source="/Images/Icons/General/info.png" Stretch="Fill" Width="16" Grid.Row="2" Height="16" VerticalAlignment="Top">
                <Image.ToolTip>
                    <TextBlock Height="Auto" TextWrapping="Wrap" Width="200">Mit einem Doppelklick auf eine Aktion wird diese Aktion entfernt. Weitere Funktionen mit Rechtsklick.</TextBlock>
                </Image.ToolTip>
            </Image>

        </Grid>
    </Grid>
</UserControl>
